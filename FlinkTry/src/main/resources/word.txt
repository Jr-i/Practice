However merely implementing the flag as a member variable in the FraudDetector class will not work Flink processes the transactions of multiple accounts with the same object instance of FraudDetector which means if accounts A and B are routed through the same instance of FraudDetector a transaction for account A could set the flag to true and then a transaction for account B could set off a false alert We could of course use a data structure like a Map to keep track of the flags for individual keys however a simple member variable would not be fault-tolerant and all its information be lost in case of a failure Hence the fraud detector would possibly miss alerts if the application ever had to restart to recover from a failure